webpackJsonp([12],{"4fAS":function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".draft-container{border:1px dashed #000;padding:10px;margin-bottom:50px;-webkit-box-sizing:border-box;box-sizing:border-box}.com-wrap{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}",""])},"5zde":function(t,e,a){a("zQR9"),a("qyJz"),t.exports=a("FeBl").Array.from},Ahtu:function(t,e,a){"use strict";function r(t){a("y+x/")}Object.defineProperty(e,"__esModule",{value:!0});var n=a("or5p"),i=a("ZaBN"),o=a("VU/8"),s=r,l=o(n.a,i.a,!1,s,null,null);e.default=l.exports},Gu7T:function(t,e,a){"use strict";e.__esModule=!0;var r=a("c/Tr"),n=function(t){return t&&t.__esModule?t:{default:t}}(r);e.default=function(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return(0,n.default)(t)}},ZaBN:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"draftResolution"}},[a("div",{staticClass:"draft-container"},[a("Form",[a("FormItem",[a("div",{staticClass:"com-wrap"},[a("div",{staticClass:"data-title"},[a("span",{staticStyle:{padding:"10px 12px 10px 0"}},[t._v("创建时间：")]),t._v(" "),a("DatePicker",{attrs:{type:"datetime",placeholder:"选择日期",clearable:"",format:"yyyy-MM-dd HH:mm"},on:{"on-change":function(e){t.draftPrams.startTime=e}}}),t._v(" "),a("span",[t._v("至")]),t._v(" "),a("DatePicker",{attrs:{type:"datetime",placeholder:"选择日期",clearable:"",format:"yyyy-MM-dd HH:mm"},on:{"on-change":function(e){t.draftPrams.endTime=e}}})],1),t._v(" "),a("div",{staticClass:"data-search"},[a("Input",{staticStyle:{width:"250px"},attrs:{placeholder:"用户ID/提案ID/提案名称"},model:{value:t.draftPrams.name,callback:function(e){t.$set(t.draftPrams,"name",e)},expression:"draftPrams.name"}}),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:t.filterHandle}},[t._v("查询")])],1)])]),t._v(" "),a("FormItem",{attrs:{label:"提案状态："}},[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":t.filterHandle},model:{value:t.statusSelect,callback:function(e){t.statusSelect=e},expression:"statusSelect"}},[a("Radio",{attrs:{label:"all"}},[t._v("全部")]),t._v(" "),t._l(t.typeAndStatus.statusList,function(e,r){return[a("Radio",{attrs:{label:e.value}},[t._v(t._s(e.name))])]})],2)],1),t._v(" "),a("br"),t._v(" "),a("FormItem",{attrs:{label:"提案类型："}},[a("RadioGroup",{attrs:{type:"button"},on:{"on-change":t.filterHandle},model:{value:t.styleSelect,callback:function(e){t.styleSelect=e},expression:"styleSelect"}},[a("Radio",{attrs:{label:"all"}},[t._v("全部")]),t._v(" "),t._l(t.typeAndStatus.typeList,function(e,r){return[a("Radio",{attrs:{label:e.value}},[t._v(t._s(e.name))])]})],2)],1),t._v(" "),a("br"),t._v(" "),a("FormItem",{attrs:{label:"待佐证提案："}},[a("span",{staticStyle:{color:"red"}},[t._v("（"+t._s(t.draftMngCount)+"）")])])],1)],1),t._v(" "),a("Table",{attrs:{border:"",stripe:"",columns:t.columns1,data:t.draftResultList}}),t._v(" "),a("div",{staticStyle:{margin:"20px 0 250px"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{current:t.currentPageNum,total:t.pageTotal,"show-total":"","show-elevator":"","show-sizer":""},on:{"update:current":function(e){t.currentPageNum=e},"on-change":function(e){return t.pageChange(e,1)},"on-page-size-change":function(e){return t.pageChange(e,0)}}})],1)]),t._v(" "),a("Modal",{attrs:{width:"360"},model:{value:t.dogfallModal,callback:function(e){t.dogfallModal=e},expression:"dogfallModal"}},[a("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"information-circled"}}),t._v(" "),a("span",[t._v("平局公示")])],1),t._v(" "),a("div",[a("RadioGroup",{attrs:{vertical:""},model:{value:t.dogfallRadio,callback:function(e){t.dogfallRadio=e},expression:"dogfallRadio"}},[t._l(t.dogfallOptions,function(e){return[a("Radio",{attrs:{label:e.id}},[a("Icon",{attrs:{type:"android-list"}}),t._v(" "),a("span",[t._v(t._s(e.content)+"(票数："+t._s(e.totalTicket)+")")])],1)]})],2)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"error",size:"large",long:"",loading:t.modal_loading},on:{click:t.dogfallPublicity}},[t._v("公示")])],1)])],1)},n=[],i={render:r,staticRenderFns:n};e.a=i},"c/Tr":function(t,e,a){t.exports={default:a("5zde"),__esModule:!0}},fBQ2:function(t,e,a){"use strict";var r=a("evD5"),n=a("X8DO");t.exports=function(t,e,a){e in t?r.f(t,e,n(0,a)):t[e]=a}},or5p:function(t,e,a){"use strict";var r=a("Gu7T"),n=a.n(r),i=a("//Fk"),o=a.n(i),s=a("gyMJ"),l=a("PJh5"),d=a.n(l),u=void 0,c=void 0;e.a={name:"draftRsoult",data:function(){var t=this;return{statusSelect:"all",styleSelect:"all",typeAndStatus:{},draftPrams:{name:"",status:"",type:"",startTime:"",endTime:"",offset:0,limit:10,sort:"endTime",order:"desc"},pageTotal:0,currentPageNum:1,draftResultList:[],draftMngCount:0,dogfallOptions:[],dogfallModal:!1,dogfallRadio:"",modal_loading:!1,columns1:[{title:"序号",key:"serialNumber",type:"index",width:"80"},{title:"提案ID",key:"id"},{title:"发起用户（ID）",key:"userPhone"},{title:"提案名称",key:"title"},{title:"结束时间",key:"endTime",render:function(t,e){return d()(e.row.endTime).format("YYYY-MM-DD HH:mm")}},{title:"提案类型",key:"typeName"},{title:"提案状态",key:"statusName"},{title:"操作",key:"edit",render:function(e,a){var r=[];return r.push(e("router-link",{props:{to:"/draftResolution/draftEdit?proposalId="+a.row.id},style:{marginRight:"5px"}},"编辑")),1==a.row.type&&7==a.row.status&&r.push(e("router-link",{props:{to:"/draftResolution/draftProof?proposalId="+a.row.id},style:{marginRight:"5px"}},"佐证")),0==a.row.type&&7==a.row.status&&r.push(e("a",{attrs:{href:"javascript:;"},style:{marginRight:"5px"},on:{click:function(){return t.publicityHandle(a.row,a.index)}}},"公示")),r.push(e("router-link",{props:{to:"/draftResolution/draftInfo?proposalId="+a.row.id},style:{marginRight:"5px"}},"查看")),e("div",r)}}]}},created:function(){var t=this;this.$Spin.show(),o.a.all([this.draftMngEvidence(),this.getProposalStatus()]).then(function(){t.$Spin.hide()}).catch(function(){return t.$Spin.hide()})},methods:{draftMngList:function(){var t=this;return"all"!=this.statusSelect?this.draftPrams.status=this.statusSelect:this.draftPrams.status="","all"!=this.styleSelect?this.draftPrams.type=this.styleSelect:this.draftPrams.type="",a.i(s.Q)(this.draftPrams).then(function(e){t.draftResultList=e.data.rows,t.pageTotal=e.data.total})},draftMngEvidence:function(){var t=this;return a.i(s.R)({}).then(function(e){t.draftMngCount=e.data.count})},getProposalStatus:function(){var t=this;return new o.a(function(e,r){a.i(s.S)().then(function(a){t.typeAndStatus=a.data;var n=t.$route.query.status;if(n&&"over"===n){a.data.statusList.forEach(function(e){"已结束"===e.name&&(t.statusSelect=e.value)}),t.draftMngList().then(function(){return e()}).catch(function(t){return r(t)})}else t.draftMngList().then(function(){return e()}).catch(function(t){return r(t)})})})},pageChange:function(t,e){e?this.draftPrams.offset=t-1:this.draftPrams.limit=t,this.draftPrams.offset=this.draftPrams.offset*this.draftPrams.limit,this.draftMngList()},filterHandle:function(){this.draftPrams.offset=0,this.draftPrams.limit=10,this.currentPageNum=1,this.draftMngList()},publicityHandle:function(t,e){var r=this,i=a.i(s.n)({id:t.id}).then(function(t){var e=0,a=void 0,i=t.data.optionList;i.forEach(function(t,r,n){t.totalTicket&&t.totalTicket>e&&(e=t.totalTicket,a=r)});var o=i.splice(a,1),s=i.filter(function(t){return t.totalTicket&&t.totalTicket==e});return s.length>0&&(r.dogfallOptions=[].concat(n()(s),n()(o))),s.length>0});this.$Modal.confirm({title:"操作确认",content:"确认立即公示提案《"+t.title+"》？",onOk:function(){i.then(function(a){u=t.id,c=e,a?r.dogfallModal=!0:r.publicity()})}})},publicity:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";a.i(s.T)({proposalId:u,winOptionId:e}).then(function(e){t.$Message.success("公示成功！"),t.draftResultList.splice(c,1)})},dogfallPublicity:function(){if(!this.dogfallRadio)return void this.$Message.error("请选择一个选项！");this.publicity(this.dogfallRadio)}}}},qyJz:function(t,e,a){"use strict";var r=a("+ZMJ"),n=a("kM2E"),i=a("sB3e"),o=a("msXi"),s=a("Mhyx"),l=a("QRG4"),d=a("fBQ2"),u=a("3fs2");n(n.S+n.F*!a("dY0y")(function(t){Array.from(t)}),"Array",{from:function(t){var e,a,n,c,f=i(t),p="function"==typeof this?this:Array,h=arguments.length,m=h>1?arguments[1]:void 0,v=void 0!==m,y=0,g=u(f);if(v&&(m=r(m,h>2?arguments[2]:void 0,2)),void 0==g||p==Array&&s(g))for(e=l(f.length),a=new p(e);e>y;y++)d(a,y,v?m(f[y],y):f[y]);else for(c=g.call(f),a=new p;!(n=c.next()).done;y++)d(a,y,v?o(c,m,[n.value,y],!0):n.value);return a.length=y,a}})},"y+x/":function(t,e,a){var r=a("4fAS");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a("rjj0")("0a7ff75b",r,!0)}});